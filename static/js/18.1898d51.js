(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{"./node_modules/lodash/_baseIntersection.js":function(t,e,n){var i=n("./node_modules/lodash/_SetCache.js"),r=n("./node_modules/lodash/_arrayIncludes.js"),a=n("./node_modules/lodash/_arrayIncludesWith.js"),s=n("./node_modules/lodash/_arrayMap.js"),l=n("./node_modules/lodash/_baseUnary.js"),o=n("./node_modules/lodash/_cacheHas.js"),c=Math.min;t.exports=function u(t,e,n){for(var u=n?a:r,d=t[0].length,f=t.length,p=f,_=Array(f),m=1/0,h=[];p--;){var v=t[p];p&&e&&(v=s(v,l(e))),m=c(v.length,m),_[p]=!n&&(e||d>=120&&v.length>=120)?new i(p&&v):void 0}v=t[0];var b=-1,y=_[0];t:for(;++b<d&&h.length<m;){var g=v[b],x=e?e(g):g;if(g=n||0!==g?g:0,!(y?o(y,x):u(h,x,n))){for(p=f;--p;){var S=_[p];if(!(S?o(S,x):u(t[p],x,n)))continue t}y&&y.push(x),h.push(g)}}return h}},"./node_modules/lodash/_baseXor.js":function(t,e,n){var i=n("./node_modules/lodash/_baseDifference.js"),r=n("./node_modules/lodash/_baseFlatten.js"),a=n("./node_modules/lodash/_baseUniq.js");t.exports=function s(t,e,n){var s=t.length;if(s<2)return s?a(t[0]):[];for(var l=-1,o=Array(s);++l<s;)for(var c=t[l],u=-1;++u<s;)u!=l&&(o[l]=i(o[l]||c,t[u],e,n));return a(r(o,1),e,n)}},"./node_modules/lodash/_castArrayLikeObject.js":function(t,e,n){var i=n("./node_modules/lodash/isArrayLikeObject.js");t.exports=function r(t){return i(t)?t:[]}},"./node_modules/lodash/intersection.js":function(t,e,n){var i=n("./node_modules/lodash/_arrayMap.js"),r=n("./node_modules/lodash/_baseIntersection.js"),a=n("./node_modules/lodash/_baseRest.js"),s=n("./node_modules/lodash/_castArrayLikeObject.js"),l=a((function(t){var e=i(t,s);return e.length&&e[0]===t[0]?r(e):[]}));t.exports=l},"./node_modules/lodash/xor.js":function(t,e,n){var i=n("./node_modules/lodash/_arrayFilter.js"),r=n("./node_modules/lodash/_baseRest.js"),a=n("./node_modules/lodash/_baseXor.js"),s=n("./node_modules/lodash/isArrayLikeObject.js"),l=r((function(t){return a(i(t,s))}));t.exports=l},"./src/components/filter_bar/filter_item.vue":function(t,e,n){"use strict";var i={props:{label:{type:String,required:!0},type:{type:String,default:"block",validator:function t(e){return["inlineBlock","block"].includes(e)}},labelWidth:Number},computed:{wrapCls:function t(){return"inlineBlock"===this.type?"filter-item--inline-block":""},labelStyle:function t(){var e={};return this.labelWidth&&(e.width="".concat(this.labelWidth,"px")),e}}},r=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),a=Object(r["a"])(i,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"filter-item",class:t.wrapCls},[n("span",{staticClass:"filter-item__label",style:t.labelStyle},[t._v("\n        "+t._s(t.label)),n("lang",[t._v("：")])],1),t._v(" "),n("div",{staticClass:"filter-item__content"},[t._t("default")],2)])}),[],!1,null,"0d6147f4",null);e["a"]=a.exports},"./src/components/filter_bar/filter_multi_select.vue":function(t,e,n){"use strict";var i=n("./node_modules/lodash/xor.js"),r=n.n(i),a=n("./node_modules/lodash/intersection.js"),s=n.n(a);function l(t,e){return function n(t){if(Array.isArray(t))return t}(t)||function i(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var i,r,a=[],s=!0,l=!1;try{for(n=n.call(t);!(s=(i=n.next()).done)&&(a.push(i.value),!e||a.length!==e);s=!0);}catch(t){l=!0,r=t}finally{try{s||null==n["return"]||n["return"]()}finally{if(l)throw r}}return a}(t,e)||c(t,e)||function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t){return function e(t){if(Array.isArray(t))return u(t)}(t)||function n(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||c(t)||function i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var d={mixins:[n("./src/components/filter_bar/filter_select_mixin.js")["a"]],props:{showThreshold:{type:Number,default:8},moreSelectOption:{type:Object,default:function t(){return{}}}},data:function t(){return{selected:[],moreSelected:[]}},computed:{optionsBtn:function t(){return this.selectOptions.slice(0,this.showThreshold)},optionsMoreSelect:function t(){return this.selectOptions.slice(this.showThreshold,this.selectOptions.length)},moreSelectAttrs:function t(){return Object.assign({placeholder:_("更多"),defaultWidth:108,displayField:this.displayField,valueField:this.valueField,type:"multi",clearable:!0},this.moreSelectOption)}},watch:{value:{immediate:!0,handler:function t(e){var n=this;this.selected=o(e),this.moreSelected=s()(this.optionsMoreSelect.map((function(t){return t[n.valueField]})),e)}}},methods:{_onSelect:function t(e){if(!this.defaultDisabled){var n=this.selected.findIndex((function(t){return t===e})),i=n>=0;this._beforeSelect(),i?this.selected.splice(n,1):this.selected.push(e),this._afterSelect(),this._updateValue()}},_onMoreSelect:function t(e,n){var i=l(r()(e,n),1)[0];this._onSelect(i)},_beforeSelect:function t(){this.selected.length&&this.selected[0]===this.allValue&&(this.selected=[],this.moreSelected=[])},_afterSelect:function t(){this.selected.length&&!this._isBtnSelected(this.allValue)||(this.selected=[this.allValue],this.moreSelected=[])},_updateValue:function t(){this.$emit("input",this.selected)},_isBtnSelected:function t(e){return this.selected.includes(e)},_calcBtnCls:function t(e){switch(!0){case this.defaultDisabled:return"multi-select__btn--disabled";case this._isBtnSelected(e):return"multi-select__btn--selected";default:return"multi-select__btn--normal"}},_clearSelectValue:function t(e){this.selected=this.selected.filter((function(t){return!e.includes(t)})),this.selected.length||(this.selected=[this.allValue]),this.$emit("input",this.selected)},clearValue:function t(){this.selected=[this.allValue],this.moreSelected=[],this.$emit("input",this.selected)}}},f=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),p=Object(f["a"])(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"multi-select"},[t._l(t.optionsBtn,(function(e,i){return n("button",{key:i,class:["multi-select__btn",t._calcBtnCls(e[t.valueField])],on:{click:function(n){return t._onSelect(e[t.valueField])}}},[t._v("\n        "+t._s(e[t.displayField])+"\n    ")])})),t._v(" "),t.optionsMoreSelect.length?n("sf-select",t._b({attrs:{"default-disabled":t.defaultDisabled,options:t.optionsMoreSelect},on:{clear:t._clearSelectValue,select:t._onMoreSelect},model:{value:t.moreSelected,callback:function(e){t.moreSelected=e},expression:"moreSelected"}},"sf-select",t.moreSelectAttrs,!1)):t._e()],2)}),[],!1,null,"3685ac59",null);e["a"]=p.exports},"./src/components/filter_bar/filter_search.vue":function(t,e,n){"use strict";var i={props:{value:{type:String,required:!0},showControl:{type:Boolean,default:!1},btnText:{type:String,default:_("搜索")}},data:function t(){return{isExpand:!0,keyword:this.value}},computed:{searchAttrs:function t(){return Object.assign({triggerType:""},this.$attrs)},expandText:function t(){return this.isExpand?_("收起"):_("展开")}},methods:{onClear:function t(){this.$emit("clear","",event)},onInput:function t(e){this.keyword=e,this.$emit("input",e)},onSearch:function t(){this.$emit("trigger",this.keyword)},clearFilter:function t(){this.$emit("clearFilter")},toggleExpand:function t(){this.isExpand=!this.isExpand,this.$emit("toggleExpand",this.isExpand)}}},r=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),a=Object(r["a"])(i,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"filter-search"},[n("sf-searchfield",t._b({staticClass:"filter-search__input",attrs:{value:t.value},on:{input:t.onInput,clear:t.onClear,trigger:t.onSearch,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch(e)}}},"sf-searchfield",t.searchAttrs,!1)),t._v(" "),n("sf-button-primary",{staticClass:"search-btn",attrs:{size:"middle","default-width":80},on:{click:t.onSearch}},[t._v("\n        "+t._s(t.btnText)+"\n    ")]),t._v(" "),t.showControl?n("div",{staticClass:"filter-search__control"},[n("span",{staticClass:"filter-search__control-btn",on:{click:t.clearFilter}},[n("lang",[t._v("清除")])],1),t._v(" "),n("span",{staticClass:"filter-search__control-btn",on:{click:t.toggleExpand}},[t._v("\n            "+t._s(t.expandText)+"\n            "),n("i",{staticClass:"iconfont icon-xiangyou filter-search__arrow-icon",class:{"filter-search__arrow-icon--rotate":!t.isExpand}})])]):t._e()],1)}),[],!1,null,"68a5a5f7",null);e["a"]=a.exports},"./src/components/filter_bar/filter_select_mixin.js":function(t,e,n){"use strict";function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t){return function e(t){if(Array.isArray(t))return a(t)}(t)||function n(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function i(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t)||function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}e["a"]={props:{value:{type:Array,required:!0},showAll:{type:Boolean,default:!0},options:{type:Array,required:!0},displayField:{type:String,default:"label"},valueField:{type:String,default:"value"},allValue:{type:[String,Number],default:"all"},allLabel:{type:String,default:_("全部")},debounceTime:{type:Number,default:500},defaultDisabled:{type:Boolean,default:!1}},computed:{selectOptions:function t(){var e;return this.showAll?[(e={},i(e,this.displayField,this.allLabel),i(e,this.valueField,this.allValue),e)].concat(r(this.options)):this.options}}}},"./src/components/filter_bar/index.vue":function(t,e,n){"use strict";var i=n("./node_modules/@sxf/sf-vue-component/dist/static/js/widgets.nocharts.js"),r=n.n(i),a=n("./src/components/filter_bar/filter_search.vue"),s=n("./node_modules/lodash/debounce.js"),l=n.n(s);function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t,e){return function n(t){if(Array.isArray(t))return t}(t)||function i(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var i,r,a=[],s=!0,l=!1;try{for(n=n.call(t);!(s=(i=n.next()).done)&&(a.push(i.value),!e||a.length!==e);s=!0);}catch(t){l=!0,r=t}finally{try{s||null==n["return"]||n["return"]()}finally{if(l)throw r}}return a}(t,e)||function r(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(t,e)}(t,e)||function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var d={components:{FilterSearch:a["a"]},mixins:[r.a.SfToolbar],props:{value:{type:String,required:!1,default:""},searchParamKey:{type:String,required:!1,default:"keyword"},clearValue:{type:Object,required:!0},showSearch:{type:Boolean,default:!0}},data:function t(){return{isShow:!0,children:[],isParentGrid:!0,reloadFlag:!0}},mounted:function t(){this.isParentGrid="sf-grid"===this.$parent.$options._componentTag,this.$_initFilterChangeEmitter(),this.$_getChildren(this),this._bindParamKey()},methods:{$_initFilterChangeEmitter:function t(){var e=this;e.$_emitFilterChanged=function(){var t={},n=function n(){e.isParentGrid&&Object.entries(t).forEach((function(t){var n=c(t,2),i=n[0],r=n[1];e._changeParentLoadParam(i,r)})),e.$emit("filter-changed",t),t={}},i=l()(n,e.debounceTime);return function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Object.assign(t,e),r?i():n()}}()},$_getChildren:function t(e){var n=this;(e.$children||[]).forEach((function(t){var e=t.$attrs||{},i=e["param-key"]||e.paramKey||t.$props.paramKey||"";i&&n.children.push({paramKey:i,child:t}),n.$_getChildren(t)}))},_bindParamKey:function t(){var e=this;this.children.forEach((function(t){var n=t.paramKey,i=t.child;e.isParentGrid&&e._setParentDefaultParam(n,i.value),i.$on("input",(function(t){e.reloadFlag&&e.$_emitFilterChanged(o({},n,t))}))}))},$_onSearchInput:function t(e){this.$emit("input",e),this.reloadFlag&&(e?this.autoSearch&&this.$_emitFilterChanged(o({},this.searchParamKey,e)):this.$_emitFilterChanged(o({},this.searchParamKey,""),!1))},$_onSearchTrigger:function t(e){this.$_emitFilterChanged(o({},this.searchParamKey,e),!1)},$_clearFilter:function t(){var e=this;this.reloadFlag=!1,this.$_onSearchInput(this.clearValue[this.searchParamKey]),this.$_emitFilterChanged(this.clearValue,!1),this.$emit("clear-filter"),this.$nextTick((function(){e.reloadFlag=!0}))}}},f=d,p=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),_=Object(p["a"])(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"filter-bar"},[t.showSearch?[n("filter-search",t._b({ref:"filterSearch",attrs:{"show-control":"",value:t.value},on:{input:t.$_onSearchInput,clear:function(e){return t.$_onSearchInput("")},trigger:t.$_onSearchTrigger,clearFilter:t.$_clearFilter,toggleExpand:function(e){t.isShow=!t.isShow}}},"filter-search",t.$attrs,!1)),t._v(" "),n("sf-collapse-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}]},[t._t("default")],2)])]:[t._t("default")]],2)}),[],!1,null,"3d47d996",null);e["a"]=_.exports},"./src/components/icon_qtip/index.vue":function(t,e,n){"use strict";var i=n("./node_modules/vue-property-decorator/lib/vue-property-decorator.js");function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(t)}var a=function(){var t=function e(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(n,i)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),s=function(t,e,n,i){var a,s=arguments.length,l=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,n,i);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(l=(s<3?a(l):s>3?a(e,n,l):a(e,n))||l);return s>3&&l&&Object.defineProperty(e,n,l),l},l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),s([Object(i["c"])({type:String,default:""})],e.prototype,"tipText",void 0),s([Object(i["c"])({type:String,default:"icon-xinxi12beifen"})],e.prototype,"iconCls",void 0),e=s([Object(i["a"])({})],e)}(i["e"]),o=l,c=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),u=Object(c["a"])(o,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("i",{directives:[{name:"qtip",rawName:"v-qtip",value:t.tipText,expression:"tipText"}],staticClass:"iconfont",class:t.iconCls,attrs:{qoffset:-11}})}),[],!1,null,null,null);e["a"]=u.exports},"./src/components/time_filter/index.vue":function(t,e,n){"use strict";var i=n("./node_modules/@sxf/sf-vue-component/dist/static/js/widgets.nocharts.js"),r=n.n(i),a=n("./src/util/tool.js"),s=n("./node_modules/dayjs/dayjs.min.js"),l=n.n(s),o={extends:r.a.SfQuickDatepicker,props:{endLimit:{type:String,default:l()().add(1,"day").format("YYYY-MM-DD")},defaultEndTime:{type:Object,default:function t(){return{hour:23,minute:59,second:59}}},valueFormat:{type:String,default:"number"},showTime:{type:Boolean,default:!0},hasMultiDimension:{type:Boolean,default:!1},quickList:{type:Array,default:function t(){return[{label:_("最近24小时"),value:1},{label:_("最近7天"),value:7},{label:_("最近30天"),value:30}]}}},created:function t(){var e=this;this.$on("click-option",(function(t){if("string"!=typeof t){Object(a["c"])();var n=Object(a["h"])(t,1===t);e.dateRange={start:l()(n.start).format("YYYY-MM-DD HH:mm:ss"),end:l()(n.end).format("YYYY-MM-DD HH:mm:ss")},e._emitDateRange()}}))},methods:{_confirmDate:function t(){Object(a["c"])(),this.isCustom&&this.dateRange.start&&this.dateRange.end&&(this.dateRange=this._encodeDateRange(this.dateRange),this.showTime&&(this.dateRange=this._parseDateRangeTimeValue(this.dateRange,this.startTimeValue,this.endTimeValue))),this._emitDateRange(),this.hide()}}},c=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),u=Object(c["a"])(o,undefined,undefined,!1,null,null,null);e["a"]=u.exports},"./src/home/mod_analysis/safety/common/utils.ts":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));var i=n("./src/const/mode_analysis.ts");function r(t){return[i["i"].value.notDisposed,i["i"].value.disposing].includes(t)}function a(t,e){return t.map((function(t){return t[e]}))}},"./src/home/mod_analysis/safety/risk_terminal/index.vue":function(t,e,n){"use strict";n.r(e);var i=n("./node_modules/vue-property-decorator/lib/vue-property-decorator.js"),r=n("./src/home/mod_common/decorators/table.ts"),a=n("./src/const/mode_analysis.ts"),s=n("./src/const/common.ts"),l=n("./src/components/filter_bar/index.vue"),o=n("./src/components/filter_bar/filter_item.vue"),c=n("./src/components/filter_bar/filter_multi_select.vue"),u={data:function t(){return{tipText:_("EDR为深信服终端检测响应平台，为终端提供精准的查杀能力和快速处置能力；未安装EDR时无法进行联动处置。")}}},d=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),f=Object(d["a"])(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"edr-tip"},[n("div",{staticClass:"edr-tip__text"},[t._v("\n        "+t._s(t.tipText)+"\n    ")]),t._v(" "),n("a",{staticClass:"common-link__text",attrs:{href:"https://www.sangfor.com.cn/product-and-solution/sangfor-security/25",noreferer:"",nopener:""}},[n("lang",[t._v("了解EDR")]),t._v(">\n    ")],1)])}),[],!1,null,"66e7d57f",null).exports,p={data:function t(){return{levelText:a["x"].text,levelVal:a["x"].value,levelCls:a["x"].cls,lowRiskList:[_("确定性等级为低可信，威胁等级为中威胁或低威胁的事件")]}}},m=Object(d["a"])(p,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"risk-level-tip"},[n("div",{staticClass:"tip-item"},[n("div",{staticClass:"tip-item__title"},[n("span",{class:[t.levelCls[t.levelVal.lost],"common-tag__circle","risk-level__tag"]},[t._v("\n                "+t._s(t.levelText[t.levelVal.lost])+"\n            ")])]),t._v(" "),n("div",{staticClass:"tip-item__content"},[n("lang",[t._v("确定性等级为高可信的所有事件")])],1)]),t._v(" "),n("div",{staticClass:"tip-item"},[n("div",{staticClass:"tip-item__title"},[n("span",{class:[t.levelCls[t.levelVal.high],"common-tag__circle","risk-level__tag"]},[t._v("\n                "+t._s(t.levelText[t.levelVal.high])+"\n            ")])]),t._v(" "),n("div",{staticClass:"tip-item__content"},[n("lang",[t._v("确定性等级为中可信的所有事件")])],1)]),t._v(" "),n("div",{staticClass:"tip-item"},[n("div",{staticClass:"tip-item__title"},[n("span",{class:[t.levelCls[t.levelVal.medium],"common-tag__circle","risk-level__tag"]},[t._v("\n                "+t._s(t.levelText[t.levelVal.medium])+"\n            ")])]),t._v(" "),n("div",{staticClass:"tip-item__content"},[n("lang",[t._v("确定性等级为低可信，并且威胁等级为高威胁的事件")])],1)]),t._v(" "),n("div",{staticClass:"tip-item"},[n("div",{staticClass:"tip-item__title"},[n("span",{class:[t.levelCls[t.levelVal.low],"common-tag__circle","risk-level__tag"]},[t._v("\n                "+t._s(t.levelText[t.levelVal.low])+"\n            ")])]),t._v(" "),n("div",{staticClass:"tip-item__content"},t._l(t.lowRiskList,(function(e,i){return n("p",{key:i},[t._v("\n                "+t._s(e)+"\n            ")])})),0)])])}),[],!1,null,"156f7966",null).exports,h=n("./src/components/local_tips/index.vue"),v=n("./src/components/time_filter/index.vue"),b=n("./src/components/risk_tags/index.vue"),y=n("./src/components/icon_qtip/index.vue"),g=n("./src/home/mod_common/mixin/table.ts"),x=n("./src/home/mod_analysis/safety/common/client_opr_mixin.ts"),S=n("./src/api/dc/mods/riskTerminal.mod.ts"),k=n("./src/util/tool.js"),w=n("./node_modules/dayjs/dayjs.min.js"),j=n.n(w),O=n("./node_modules/@sxf/util/type_of.js"),C=n("./src/home/mod_analysis/safety/common/utils.ts"),$=n("./src/home/mod_common/router_cache/index.ts");function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(t)}var P=function(){var t=function e(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(n,i)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),L=function(){return L=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},L.apply(this,arguments)},A=function(t,e,n,i){var r,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":T(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(s=(a<3?r(s):a>3?r(e,n,s):r(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},E=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function s(t){try{o(i.next(t))}catch(t){a(t)}}function l(t){try{o(i["throw"](t))}catch(t){a(t)}}function o(t){t.done?r(t.value):function e(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(s,l)}o((i=i.apply(t,e||[])).next())}))},D=function(t,e){var n,i,r,a,s={label:0,sent:function t(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function o(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&a[0]?i["return"]:a[0]?i["throw"]||((r=i["return"])&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},F=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n},M=[{dataIndex:"terminal_id",defaultShow:!1},"terminal_user","terminal_ip","mac_address","risk_level","risk_keyword","last_time","edrStatusText","deal_status"].map((function(t){return Object(O["c"])(t)?t:{dataIndex:t,defaultShow:!0}}));function R(t){var e=t.filter_time,n=F(t,["filter_time"]);return L(L({},n),{start_time:e.start,end_time:e.end})}var I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.DISPOSAL_STATUS=a["i"],e.RISK_LEVEL=a["x"],e.LINKAGE_STATUS=a["t"],e.EDR_STATUS=a["n"],e.filterStartLimit=j()().subtract(180,"day").format("YYYY-MM-DD"),e.disposeStatusOptions=a["i"].terminalOptions,e.getFieldList=C["b"],e.formatLoadParams=Object.freeze(R),e.linkageStatus={inLinkage:0,linkageCompleted:0},e.clientCount=0,e.EdrTip=f,e.RiskLevelTip=m,e.isLinkageDisabled=!0,e.isMarkDisposedDisabled=!0,e}return P(e,t),Object.defineProperty(e.prototype,"showLinkageStatus",{get:function t(){return this.linkageStatus.inLinkage+this.linkageStatus.linkageCompleted>0},enumerable:!1,configurable:!0}),e.prototype.created=function(){this.setLinkageStatus()},e.prototype.activated=function(){$["a"].refreshData(this.$_tableMixin_refresh)},e.prototype.getTableData=function(t){return E(this,void 0,void 0,(function(){var e,n=this;return D(this,(function(i){switch(i.label){case 0:return[4,S["a"].getRiskTerminal(R(t))];case 1:return(e=i.sent()).list.forEach((function(t){var e=a["i"].text[t.deal_status];Object.assign(t,{riskLevelText:a["x"].text[t.risk_level],edrStatusText:a["n"].text[t.edr_status],disposalStatusText:e,disposalStatusCls:a["i"].cls[t.deal_status],oprList:n.getOprList(t)})})),[2,e]}}))}))},e.prototype.setLinkageStatus=function(){return E(this,void 0,void 0,(function(){return D(this,(function(t){return this.linkageStatus={inLinkage:2,linkageCompleted:3},[2]}))}))},e.prototype.getOprList=function(t){var e=this,n=Object(C["a"])(t.deal_status);return[{text:_("标记已处置"),show:n,disabled:!1,action:function n(){return e.$_clientOprMixin_markDisposed([t.terminal_id],e.$_tableMixin_refresh)}},{text:_("处置进度"),show:t.deal_status===a["i"].value.disposing,disabled:!1,action:function n(){return e.$_clientOprMixin_checkDisposeRecord(t.record_id)}},{text:_("处置记录{#opr#}"),show:t.deal_status===a["i"].value.disposed,disabled:!1,action:function n(){return e.$_clientOprMixin_checkDisposeRecord(t.record_id)}}].filter((function(t){return t.show}))},e.prototype.filterLinkageRecord=function(t){this.tableOptions.loadParams&&(this.tableOptions.loadParams.deal_status=[a["i"].value.disposing],this.tableOptions.loadParams.linkage_status=t,this.$_tableMixin_refresh())},e.prototype.clearLinkageStatus=function(){this.tableOptions.loadParams&&(this.tableOptions.loadParams.linkage_status=s["c"])},e.prototype.onSelectionsChanged=function(){var t=this.$_tableMixin_getAllSelections();this.isLinkageDisabled=!t.length||t.some((function(t){return t.edr_status!==a["n"].value.installed})),this.isMarkDisposedDisabled=!t.length},A([Object(i["c"])({type:String,default:["all"]})],e.prototype,"riskLevels",void 0),A([Object(r["a"])((function(t){return{selectionHide:!1,selectionMode:"multi",idProperty:"terminal_id",remoteSort:!0,toggleColumns:M,loadParams:{keyword:"",deal_status:["all"],linkage_status:s["c"],risk_level:t.riskLevels,edr_status:a["n"].value.notInstalled,sort_direction:s["o"].desc,sort_field:"last_time",filter_time:Object(k["h"])(7)},loadFn:function e(n){return E(this,void 0,void 0,(function(){var e;return D(this,(function(i){switch(i.label){case 0:return[4,t.getTableData(n)];case 1:return e=i.sent(),t.clientCount=e.total,[2,e]}}))}))}}}))],e.prototype,"tableOptions",void 0),e=A([Object(i["a"])({name:"safetyAnalysisRiskTerminal",components:{FilterBar:l["a"],FilterItem:o["a"],FilterMultiSelect:c["a"],LocalTips:h["a"],TimeFilter:v["a"],RiskTags:b["a"],IconQtip:y["a"]}})],e)}(Object(i["b"])(g["a"],x["a"])),V=I,q=Object(d["a"])(V,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("auto-breadcrumb"),t._v(" "),n("sf-card",{directives:[{name:"set-min-height",rawName:"v-set-min-height"}],staticClass:"common-content--padding",attrs:{title:t._("风险终端（{0}）{#title#}",t.clientCount)}},[n("sf-grid",{directives:[{name:"set-height",rawName:"v-set-height"}],staticClass:"common-flex-grid"},[n("filter-bar",{attrs:{"show-search":!1}},[n("filter-item",{attrs:{label:t._("处置状态{#title#}"),type:"inlineBlock"}},[n("filter-multi-select",{attrs:{"param-key":"deal_status",options:t.disposeStatusOptions},on:{input:t.clearLinkageStatus},model:{value:t.tableOptions.loadParams.deal_status,callback:function(e){t.$set(t.tableOptions.loadParams,"deal_status",e)},expression:"tableOptions.loadParams.deal_status"}})],1),t._v(" "),n("filter-item",{attrs:{label:t._("风险等级{#title#}"),type:"inlineBlock"}},[n("filter-multi-select",{attrs:{"param-key":"risk_level",options:t.RISK_LEVEL.options},model:{value:t.tableOptions.loadParams.risk_level,callback:function(e){t.$set(t.tableOptions.loadParams,"risk_level",e)},expression:"tableOptions.loadParams.risk_level"}})],1),t._v(" "),n("div",[n("filter-item",{staticClass:"common-textfiled--small",attrs:{label:t._("事件发生时间{#title#}"),type:"inlineBlock"}},[n("time-filter",{attrs:{"start-limit":t.filterStartLimit,name:"filter_time","param-key":"filter_time"},model:{value:t.tableOptions.loadParams.filter_time,callback:function(e){t.$set(t.tableOptions.loadParams,"filter_time",e)},expression:"tableOptions.loadParams.filter_time"}})],1)],1),t._v(" "),n("div",{staticClass:"common-grid-toolbar clearfix"},[n("sf-button",{staticClass:"btn-blank",attrs:{"icon-cls":"icon-biaoweiyichuzhi","default-disabled":t.tableMixin_toolbarBtnDisabled},on:{click:function(e){t.$_clientOprMixin_markDisposed(t.getFieldList(t.$_tableMixin_getAllSelections(),"terminal_id"),t.$_tableMixin_refresh)}}},[n("lang",[t._v("标记为已处置")])],1),t._v(" "),n("sf-button",{staticClass:"btn-blank",attrs:{"icon-cls":"icon-daochu"},on:{click:function(e){t.$_clientOprMixin_exportTerminal(Object.assign({},{ids:t.getFieldList(t.$_tableMixin_getAllSelections(),"terminal_id")},t.formatLoadParams(t.tableOptions.loadParams)),t.$_tableMixin_refresh)}}},[n("lang",[t._v("导出")])],1),t._v(" "),n("div",{staticClass:"common-pull-right"},[n("sf-searchfield",{attrs:{"param-key":"keyword","default-width":280,placeholder:t._("请输入账号名、显示名、终端IP、MAC地址")},model:{value:t.tableOptions.loadParams.keyword,callback:function(e){t.$set(t.tableOptions.loadParams,"keyword",e)},expression:"tableOptions.loadParams.keyword"}})],1)],1)],1),t._v(" "),n("sf-table",{ref:"table",attrs:{"default-height":0,options:t.tableOptions},on:{selectionchange:t.onSelectionsChanged},scopedSlots:t._u([{key:"terminal_user",fn:function(e){var i=e.record;return[n("span",{directives:[{name:"title",rawName:"v-title"}],staticClass:"common-link__text",on:{click:function(e){return e.stopPropagation(),t.$_clientOprMixin_checkDetail(i,t.tableOptions.loadParams.filter_time)}}},[t._v("\n                        "+t._s(t._f("empty")(i.account||i.terminal_ip))+"\n                    ")])]}},{key:"risk_level",fn:function(e){var i=e.record;return[i.risk_level?n("span",{directives:[{name:"title",rawName:"v-title"}],class:[t.RISK_LEVEL.cls[i.risk_level],"common-tag__circle","risk-level__tag"]},[t._v("\n                        "+t._s(t.RISK_LEVEL.text[i.risk_level])+"\n                    ")]):n("span",[t._v("\n                        -\n                    ")])]}},{key:"deal_status",fn:function(e){var i=e.record;return[i.deal_status?n("span",{directives:[{name:"title",rawName:"v-title"}],class:[i.disposalStatusCls]},[t._v("\n                        "+t._s(t._f("empty")(i.disposalStatusText))+"\n                    ")]):n("span",[t._v("\n                        -\n                    ")])]}}])},[n("sf-table-column",{attrs:{"data-index":"terminal_id","default-width":.1,title:t._("终端ID{#header#}")}}),t._v(" "),n("sf-table-column",{attrs:{"data-index":"terminal_user","default-width":.15}},[n("lang",[t._v("用户名{#header#}")]),t._v(" "),n("icon-qtip",{staticClass:"common-form-tips-icon",attrs:{"tip-text":t._("用户名=账号名（显示名）{#tip#}")}})],1),t._v(" "),t._v(" "),n("sf-table-column",{attrs:{"data-index":"terminal_ip","default-width":.12,title:t._("终端IP{#header#}")}}),t._v(" "),n("sf-table-column",{attrs:{"data-index":"mac_address","default-width":.12,title:t._("MAC地址{#header#}")}}),t._v(" "),n("sf-table-column",{attrs:{"data-index":"risk_level","default-width":.1,"min-width":90}},[n("lang",[t._v("风险等级")]),t._v(" "),n("i",{directives:[{name:"qtip",rawName:"v-qtip",value:t.RiskLevelTip,expression:"RiskLevelTip"}],staticClass:"iconfont icon-xinxi12beifen tip-icon",attrs:{qoffset:-11,qmaxwidth:1e3}})],1),t._v(" "),t._v(" "),n("sf-table-column",{attrs:{"data-index":"risk_keyword","default-width":.25,title:t._("事件标签{#header#}")},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.record;return n("risk-tags",{key:e.record_id,attrs:{list:e.risk_keyword}})}}])}),t._v(" "),n("sf-table-column",{attrs:{"data-index":"last_time","default-width":.15,"sort-able":!0,title:t._("最近发生时间{#header#}")}}),t._v(" "),n("sf-table-column",{attrs:{"data-index":"deal_status","default-width":.1}},[n("lang",[t._v("处置状态")]),t._v(" "),n("i",{directives:[{name:"qtip",rawName:"v-qtip",value:t._("若风险终端7天内未发现新的安全事件，将自动标记为已处置"),expression:"_('若风险终端7天内未发现新的安全事件，将自动标记为已处置')"}],staticClass:"iconfont icon-xinxi12beifen tip-icon",attrs:{qoffset:-11}})],1),t._v(" "),t._v(" "),n("sf-table-column",{attrs:{"data-index":"opr",title:t._("操作{#header#}"),"default-width":180},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.record;return[t._l(i.oprList,(function(e,r){return n("span",{directives:[{name:"title",rawName:"v-title"}],key:r,staticClass:"common-link__text-margin",class:{"common-link__text--disabled":e.disabled},on:{click:function(t){return t.stopPropagation(),e.action(i)}}},[t._v("\n                            "+t._s(e.text)+"\n                        ")])})),t._v(" "),i.oprList.length?t._e():n("span",[t._v("\n                            -\n                        ")])]}}])})],1)],1)],1)],1)}),[],!1,null,"31745244",null);e["default"]=q.exports}}]);