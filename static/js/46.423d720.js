(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[46],{"./src/components/recommended_strategy_layer/index.vue":function(t,e,n){"use strict";var o=n("./node_modules/vue-property-decorator/lib/vue-property-decorator.js");function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(t)}var r=function(){var t=function e(n,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(n,o)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.addCustomizeStrategy=function(t){this.$emit("add-strategy",t)},i([Object(o["c"])({type:Array,default:function t(){return[]}})],e.prototype,"recommendedStrategy",void 0),e=i([Object(o["a"])({})],e)}(o["e"]),c=s,l=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),d=Object(l["a"])(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"recommended-strategy"},[n("div",{ref:"recommendedTemplate",staticClass:"recommended-strategy__title--right common-link__text"},[n("lang",[t._v("推荐配置{#btn#}")]),t._v(" "),n("i",{staticClass:"iconfont icon-xinxi12beifen common-form-tips-icon recommended-strategy__icon"})],1),t._v(" "),n("sf-layer",{attrs:{"default-target":"recommendedTemplate",trigger:"hover","arrow-hide":!1,anchor:"top-end",offset:4,cls:"recommended-strategy__option-layer"}},[n("ul",{staticClass:"recommended-strategy__select"},t._l(t.recommendedStrategy,(function(e,o){return n("li",{key:o,staticClass:"sfv-option sfv-option-text recommended-strategy__option",on:{click:function(n){return t.addCustomizeStrategy(e.data)}}},[t._v("\n                "+t._s(e.name)+"\n            ")])})),0)])],1)}),[],!1,null,"cc2548ca",null);e["a"]=d.exports},"./src/home/mod_strategy/online_strategy/behavior_audit/app_audit/index.vue":function(t,e,n){"use strict";n.r(e);var o=n("./node_modules/vue-property-decorator/lib/vue-property-decorator.js"),a=n("./src/home/mod_strategy/common/strategy_index_mixin.ts"),r=n("./src/components/add_strategy_type_select/index.vue"),i=n("./src/components/recommended_strategy_layer/index.vue"),s=n("./src/home/mod_strategy/online_strategy/behavior_audit/app_audit/modal/add_strategy/index.vue"),c=n("./src/home/mod_strategy/online_strategy/behavior_audit/app_audit/detail/index.vue"),l=n("./src/components/local_tips/index.vue"),d=n("./src/home/mod_strategy/common/tip_layer.vue");function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(t)}var p=function(){var t=function e(n,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(n,o)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),f=function(t,e,n,o){var a,r=arguments.length,i=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(i=(r<3?a(i):r>3?a(e,n,i):a(e,n))||i);return r>3&&i&&Object.defineProperty(e,n,i),i},y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e=f([o["a"]],e)}(o["e"]),m=y,g=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),b=Object(g["a"])(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("p",{staticClass:"sfv-modal_content-msg"},[t._v("\n        "+t._s(t._("确定要创建Web端审计策略吗?"))+"\n    ")]),t._v(" "),n("p",{staticClass:"sfv-modal_content-desc"},[n("span",[t._v(t._s(t._("您尚未创建内容识别策略，将导致https的内容审计")))])]),t._v(" "),n("p",{staticClass:"sfv-modal_content-desc"},[n("span",{staticClass:"content-desc--orange"},[t._v("\n            "+t._s(t._("无法生效。"))+"\n        ")])]),t._v(" "),n("p",{staticClass:"sfv-modal_content-desc"},[n("span",[t._v(t._s(t._("前往设置")))]),t._v(" "),n("router-link",{staticClass:"common-link__text",attrs:{to:{name:"strategyOnlineContentRecognition"},rel:"noopener noreferrer",target:"_blank"}},[t._v("\n            "+t._s(t._("内容识别策略{#btn#}"))+"\n        ")])],1)])}),[],!1,null,"01e73d8f",null).exports,v=n("./src/const/mod_strategy.ts"),h=n("./src/const/common.ts"),S=n("./src/api/swagger/mods/strategyAppAudit.mod.ts"),w=n("./src/home/mod_common/util/tool.ts");function x(t){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(t)}var k=function(){var t=function e(n,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(n,o)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),O=function(t,e,n,o){var a,r=arguments.length,i=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===("undefined"==typeof Reflect?"undefined":x(Reflect))&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(i=(r<3?a(i):r>3?a(e,n,i):a(e,n))||i);return r>3&&i&&Object.defineProperty(e,n,i),i},C=function(t,e,n,o){return new(n||(n=Promise))((function(a,r){function i(t){try{c(o.next(t))}catch(t){r(t)}}function s(t){try{c(o["throw"](t))}catch(t){r(t)}}function c(t){t.done?a(t.value):function e(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(i,s)}c((o=o.apply(t,e||[])).next())}))},R=function(t,e){var n,o,a,r,i={label:0,sent:function t(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function c(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(a=2&r[0]?o["return"]:r[0]?o["throw"]||((a=o["return"])&&a.call(o),0):o.next)&&!(a=a.call(o,r[1])).done)return a;switch(o=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,o=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==r[0]&&2!==r[0])){i=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){i.label=r[1];break}if(6===r[0]&&i.label<a[1]){i.label=a[1],a=r;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(r);break}a[2]&&i.ops.pop(),i.trys.pop();continue}r=e.call(t,i)}catch(t){r=[6,t],o=0}finally{n=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.operationMap={getStrategys:S["a"].list,changeStatus:S["a"].status,deleteRecords:S["a"].remove,draggableSort:S["a"].changePriority},e.hasContentRecognitionStrategy=!1,e.formatApplicationScope=w["a"],e.recommendedStrategy=[],e.editBtnDisabled=!0,e}return k(e,t),e.prototype.onHandleKeyword=function(t){this.$_draggableMixin_filter(t)},e.prototype.mounted=function(){this.getHasContentRecognitionStrategy()},e.prototype.editStrategyModal=function(){var t=this,e=t.$refs.detail,n=null==e?void 0:e.$_detailMixin_getDetail();t.$_strategyModalMixin_editStrategyModal(s["a"],{width:640,props:{templateData:n,isEdit:!0},submit:t.filterRemind,submitCallback:function n(){var o;t.$_tableMixin_refresh(),null===(o=null==e?void 0:e.$_detailMixin_loadDetail)||void 0===o||o.call(e)}})},e.prototype.selectAddStrategyType=function(){this.$_strategyModalMixin_selectAddStrategyType(r["a"],{width:400,props:{addCustomizeStrategy:this.openNewStrategyModal,recommendedStrategy:this.recommendedStrategy,displayType:"modal"}})},e.prototype.beforeOpenNewStrategyModal=function(){var t=this;t.hasContentRecognitionStrategy?t.openNewStrategyModal():this.$confirm({title:_("提示"),msg:b,submit:function e(){t.openNewStrategyModal()}})},e.prototype.openNewStrategyModal=function(t){this.$_strategyModalMixin_addStrategy(s["a"],{width:640,props:{templateData:t}})},e.prototype.renderAuditContent=function(t){return t.map((function(t){return v["e"].text[t]})).join(_("、"))||"-"},e.prototype.getHasContentRecognitionStrategy=function(){return C(this,void 0,void 0,(function(){var t,e;return R(this,(function(n){switch(n.label){case 0:return[4,S["a"].checkContentDetect()];case 1:return t=n.sent().status,e=void 0===t?h["n"].value.disable:t,this.hasContentRecognitionStrategy=e===h["n"].value.enable,[2]}}))}))},e.prototype.loadRecommendedStrategys=function(){return C(this,void 0,void 0,(function(){var t,e;return R(this,(function(n){switch(n.label){case 0:return[4,this.$http.get("template/app-audit")];case 1:return t=n.sent().list,e=void 0===t?[]:t,this.recommendedStrategy=e,[2]}}))}))},e.prototype.updateDrawerStatus=function(t){this.strategyRecord.name=t.name||"-",this.setEditBtnDisabled(!1)},e.prototype.setEditBtnDisabled=function(t){this.editBtnDisabled=t},e=O([Object(o["a"])({components:{LocalTips:l["a"],AddStrategyTypeSelect:r["a"],RecommendedStrategy:i["a"],AppAuditDetail:c["a"],TipLayer:d["a"]}})],e)}(Object(o["b"])(a["a"])),M=j,T=Object(g["a"])(M,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("sf-card",{directives:[{name:"set-min-height",rawName:"v-set-min-height"}],staticClass:"common-content--padding common-card--no-head-padding app-audit"},[n("div",{attrs:{slot:"title"},slot:"title"},[n("lang",[t._v("Web端审计策略{#title#}")]),t._v(" "),n("tip-layer",{ref:"tipLayer",attrs:{"tip-text":t._("互联网应用审计，未配置的内容默认不审计。")}})],1),t._v(" "),t._e(),t._v(" "),n("sf-grid",{directives:[{name:"show",rawName:"v-show",value:t.strategysLength||t.isTableLoding,expression:"strategysLength || isTableLoding"}],key:t.mixinKey},[n("sf-toolbar",{ref:"toolbar"},[n("sf-button-blank",{staticClass:"btn-blank",attrs:{"default-disabled":t.isTableLoding,"icon-cls":"icon-gongjulan-xinzeng"},on:{click:function(e){return t.beforeOpenNewStrategyModal()}}},[n("lang",[t._v("新增{#btn#}")])],1),t._v(" "),n("sf-button-blank",{staticClass:"btn-blank",attrs:{"action-name":"delete","icon-cls":"icon-gongjulan-shanchu"},on:{click:t.filterRemind}},[n("lang",[t._v("删除{#btn#}")])],1),t._v(" "),n("ss-vertical-sep",{attrs:{spacing:0}}),t._v(" "),n("sf-button-blank",{staticClass:"btn-blank",attrs:{"action-name":"enable","icon-cls":"icon-enable"},on:{click:t.filterRemind}},[n("lang",[t._v("启用{#btn#}")])],1),t._v(" "),n("sf-button-blank",{staticClass:"btn-blank",attrs:{"action-name":"disable","icon-cls":"icon-disable"},on:{click:t.filterRemind}},[n("lang",[t._v("禁用{#btn#}")])],1),t._v(" "),n("template",{slot:"right"},[n("sf-searchfield",{attrs:{"param-key":"keyword",placeholder:t._("请输入策略名称")},on:{trigger:t.filterRemind},model:{value:t.gridOption.loadParams.keyword,callback:function(e){t.$set(t.gridOption.loadParams,"keyword",e)},expression:"gridOption.loadParams.keyword"}})],1)],2),t._v(" "),n("sf-table",{directives:[{name:"set-min-height",rawName:"v-set-min-height"}],ref:"table",attrs:{options:t.gridOption,"default-height":300}},[n("sf-table-column",{attrs:{"data-index":"priority",title:t._("优先级{#header#}"),align:"center","default-width":60}}),t._v(" "),n("sf-table-column",{attrs:{"data-index":"name",title:t._("策略名称{#header#}"),"default-width":136},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.record;return[n("span",{staticClass:"common-ellipsis common-link__text",attrs:{title:o.name},on:{click:function(e){return e.stopPropagation(),t.$_strategyModalMixin_openDetailDrawer(o)}}},[t._v("\n                        "+t._s(t._f("empty")(o.name))+"\n                    ")])]}}])}),t._v(" "),n("sf-table-column",{attrs:{"data-index":"content",title:t._("内容{#header#}"),renderer:t.renderAuditContent,"default-width":.4}}),t._v(" "),n("sf-table-column",{attrs:{"data-index":"application",title:t._("适用范围{#header#}"),"default-width":.6},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.record;return[t.$_strategyMixin_isScopeShow(o)?n("div",{staticClass:"app-audit__scope"},t._l(o.application_scope.scope,(function(e,a){return n("p",{key:a,staticClass:"common-ellipsis app-audit__scope-item",attrs:{title:t.formatApplicationScope(o.application_scope,e)}},[t._v("\n                            "+t._s(t.formatApplicationScope(o.application_scope,e))+"\n                        ")])})),0):n("span",[t._v("\n                        -\n                    ")])]}}])}),t._v(" "),n("sf-table-column",{attrs:{"data-index":"time_name",title:t._("生效时间{#header#}"),"default-width":104}}),t._v(" "),n("sf-table-column",{attrs:{"data-index":"status",title:t._("策略状态{#header#}"),"default-width":80},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.record;return[o.status?n("i",{staticClass:"iconfont",class:[t.STATUS.icon[o.status],"common-status-icon--"+o.status],attrs:{title:o.status===t.STATUS.value.enable?t.STATUS.actionText.disable:t.STATUS.actionText.enable},on:{click:function(e){return e.stopPropagation(),t.filterRemind(e)}}}):n("span",[t._v("\n                        -\n                    ")])]}}])}),t._v(" "),n("sf-table-column",{attrs:{"data-index":"creator",title:t._("创建人{#header#}"),"default-width":80}}),t._v(" "),n("sf-table-column",{attrs:{title:t._("操作{#header#}"),"default-width":160}},[n("div",{staticClass:"app-audit__operation"},[n("span",{staticClass:"common-link__text-margin",on:{click:function(e){return e.stopPropagation(),t.filterRemind(e)}}},[t._v("\n                        "+t._s(t._("删除{#btn#}"))+"\n                    ")]),t._v(" "),t.gridOption.loadParams.keyword?t._e():n("draggable-handler")],1)])],1)],1),t._v(" "),t.strategysLength||t.isTableLoding?t._e():n("add-strategy-type-select",{attrs:{"add-customize-strategy":t.beforeOpenNewStrategyModal,"recommended-strategy":t.recommendedStrategy,"display-type":"table"}}),t._v(" "),n("sf-drawer",{attrs:{title:t.strategyRecord.name,visible:t.isDetailShow,size:"640px",direction:"rtl","destroy-on-close":!0},on:{"update:visible":function(e){t.isDetailShow=e}}},[n("app-audit-detail",{ref:"detail",attrs:{record:t.strategyRecord},on:{"before-load":function(e){return t.setEditBtnDisabled(!0)},"after-load":t.updateDrawerStatus}}),t._v(" "),n("template",{slot:"footer"},[n("sf-button-primary",{attrs:{"default-disabled":t.editBtnDisabled},on:{click:t.editStrategyModal}},[n("lang",[t._v("编辑")])],1)],1)],2)],1)}),[],!1,null,"ada5c182",null);e["default"]=T.exports}}]);