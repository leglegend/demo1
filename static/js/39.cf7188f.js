(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[39],{"./src/components/recommended_strategy_layer/index.vue":function(t,e,n){"use strict";var o=n("./node_modules/vue-property-decorator/lib/vue-property-decorator.js");function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(t)}var r=function(){var t=function e(n,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(n,o)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=function(t,e,n,o){var r,a=arguments.length,s=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(s=(a<3?r(s):a>3?r(e,n,s):r(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.addCustomizeStrategy=function(t){this.$emit("add-strategy",t)},a([Object(o["c"])({type:Array,default:function t(){return[]}})],e.prototype,"recommendedStrategy",void 0),e=a([Object(o["a"])({})],e)}(o["e"]),l=s,c=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),u=Object(c["a"])(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"recommended-strategy"},[n("div",{ref:"recommendedTemplate",staticClass:"recommended-strategy__title--right common-link__text"},[n("lang",[t._v("推荐配置{#btn#}")]),t._v(" "),n("i",{staticClass:"iconfont icon-xinxi12beifen common-form-tips-icon recommended-strategy__icon"})],1),t._v(" "),n("sf-layer",{attrs:{"default-target":"recommendedTemplate",trigger:"hover","arrow-hide":!1,anchor:"top-end",offset:4,cls:"recommended-strategy__option-layer"}},[n("ul",{staticClass:"recommended-strategy__select"},t._l(t.recommendedStrategy,(function(e,o){return n("li",{key:o,staticClass:"sfv-option sfv-option-text recommended-strategy__option",on:{click:function(n){return t.addCustomizeStrategy(e.data)}}},[t._v("\n                "+t._s(e.name)+"\n            ")])})),0)])],1)}),[],!1,null,"cc2548ca",null);e["a"]=u.exports},"./src/home/mod_strategy/online_strategy/control_strategy/terminal_control/detail/index.vue":function(t,e,n){"use strict";var o=n("./node_modules/vue-property-decorator/lib/vue-property-decorator.js"),i=n("./src/components/application_scope/index.vue"),r=n("./src/api/swagger/mods/strategyTerminalControl.mod.ts"),a=n("./src/home/mod_strategy/common/detail_mixin.ts"),s=n("./src/const/mod_strategy.ts");function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(t)}var c=function(){var t=function e(n,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(n,o)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),u=function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===("undefined"==typeof Reflect?"undefined":l(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},d=function(t,e,n,o){return new(n||(n=Promise))((function(i,r){function a(t){try{l(o.next(t))}catch(t){r(t)}}function s(t){try{l(o["throw"](t))}catch(t){r(t)}}function l(t){t.done?i(t.value):function e(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,s)}l((o=o.apply(t,e||[])).next())}))},p=function(t,e){var n,o,i,r,a={label:0,sent:function t(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function l(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o["return"]:r[0]?o["throw"]||((i=o["return"])&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.AUDIT_SETTINGS_TYPE=s["i"],e.AUDIT_SETTINGS_ACTION=s["h"],e.detail={name:"",description:"",status:"",priority:"",time_id:"",time_name:"",setting:{disk:"",mobile:"",net:"",bluetooth:"",camera:"",printer:""},application_scope:{scope:[],users:[],terminal:[],source_ip:{type:"",list:[]},destination_ip:{type:"",list:[]}}},e.userTreeData=[],e.textRenderOptions={labelWidth:96,lineHeight:24},e.operationMap={load:r["a"].detail},e}return c(e,t),e.prototype.mounted=function(){this.loadUserTreeData(),this.textRenderOptions.labelWidth=this.$isEnglish?126:96},e.prototype.loadUserTreeData=function(){return d(this,void 0,void 0,(function(){var t;return p(this,(function(e){switch(e.label){case 0:return[4,r["a"].userGroup({},{mask:this.$parent})];case 1:return t=e.sent(),this.userTreeData=t?[t]:[],[2]}}))}))},e=u([Object(o["a"])({components:{ApplicationScope:i["a"]}})],e)}(Object(o["b"])(a["a"])),m=f,y=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),_=Object(y["a"])(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"strategy-detail"},[n("lang",{staticClass:"common-form-title"},[t._v("基本信息{#title#}")]),t._v(" "),t._l(t.basicInfo,(function(e,o){return n("ss-text-render",t._b({key:o,staticClass:"detail-item"},"ss-text-render",e,!1))})),t._v(" "),n("lang",{staticClass:"common-form-title"},[t._v("管控设置{#title#}")]),t._v(" "),t._l(t.AUDIT_SETTINGS_TYPE.options,(function(e,o){return n("ss-text-render",t._b({key:o,staticClass:"detail-item",attrs:{"label-text":e.label,value:t.AUDIT_SETTINGS_ACTION.text[t.detail.setting[e.value]]}},"ss-text-render",t.textRenderOptions,!1))})),t._v(" "),n("ss-text-render",t._b({staticClass:"detail-item",attrs:{"label-text":t._("生效时间{#label#}"),value:t.detail.time_name}},"ss-text-render",t.textRenderOptions,!1)),t._v(" "),n("lang",{staticClass:"common-form-title"},[t._v("适用范围{#title#}")]),t._v(" "),n("ss-text-render",t._b({staticClass:"detail-item",attrs:{"label-text":t._("适用范围{#label#}")}},"ss-text-render",t.textRenderOptions,!1),[n("application-scope",{attrs:{"user-tree-data":t.userTreeData,"default-disabled":!0,"input-width":460,"is-terminal-control":!0},model:{value:t.detail.application_scope,callback:function(e){t.$set(t.detail,"application_scope",e)},expression:"detail.application_scope"}})],1)],2)}),[],!1,null,"07a10e90",null);e["a"]=_.exports},"./src/home/mod_strategy/online_strategy/control_strategy/terminal_control/index.vue":function(t,e,n){"use strict";n.r(e);var o=n("./node_modules/vue-property-decorator/lib/vue-property-decorator.js"),i=n("./src/home/mod_strategy/common/strategy_index_mixin.ts"),r=n("./src/home/mod_strategy/online_strategy/control_strategy/terminal_control/modal/add_strategy/index.vue"),a=n("./src/components/add_strategy_type_select/index.vue"),s=n("./src/components/recommended_strategy_layer/index.vue"),l=n("./src/home/mod_strategy/online_strategy/control_strategy/terminal_control/detail/index.vue"),c=n("./src/home/mod_strategy/common/tip_layer.vue"),u=n("./src/components/user_guide/guide_mixin.ts"),d=n("./src/const/guide/strategy_config.ts"),p=n("./src/api/swagger/mods/strategyTerminalControl.mod.ts"),f=n("./src/home/mod_common/decorators/table.ts"),m=n("./src/home/mod_common/util/tool.ts");function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(t)}var h=function(){var t=function e(n,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(n,o)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),v=function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===("undefined"==typeof Reflect?"undefined":y(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},b=function(t,e,n,o){return new(n||(n=Promise))((function(i,r){function a(t){try{l(o.next(t))}catch(t){r(t)}}function s(t){try{l(o["throw"](t))}catch(t){r(t)}}function l(t){t.done?i(t.value):function e(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,s)}l((o=o.apply(t,e||[])).next())}))},g=function(t,e){var n,o,i,r,a={label:0,sent:function t(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function l(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o["return"]:r[0]?o["throw"]||((i=o["return"])&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.operationMap={deleteRecords:p["a"].remove,changeStatus:p["a"].setStatus,getStrategys:p["a"].list,draggableSort:p["a"].changePriority},e.formatApplicationScope=m["a"],e.USER_GUIDE=d["a"],e.recommendedStrategy=[],e.isFirstLoadStrategyOrigin=!1,e.editBtnDisabled=!0,e}return h(e,t),e.prototype.mounted=function(){},e.prototype.$_guideMixin_onNext=function(){var t,e=this.guideMixin_guideDriver.hasHighlightedElement().className;e.indexOf(d["a"].value.configGuide)>-1&&(this.$root.$emit("open-menu","strategy"),this.guideMixin_guideDriver.defineSteps(this.guideMixin_steps),null===(t=this.strategyMixin_GuideModal)||void 0===t||t.hide()),e.indexOf(d["a"].value.controlStrategy)>-1&&this.$root.$emit("open-menu",""),this.guideMixin_guideDriver.hasNextStep()||(this.guideMixin_guideCompleted=!0)},e.prototype.$_guideMixin_beforeReset=function(){var t;this.$root.$emit("open-menu",""),null===(t=this.strategyMixin_GuideModal)||void 0===t||t.hide(),this.updateIsConfigGuideShow(this.isFirstLoadStrategyOrigin)},e.prototype.$_guideMixin_editSteps=function(t){return t.forEach((function(t){t.element.indexOf(d["a"].value.configGuide)>-1&&(t.popover.offset=0,t.popover.margin=16,t.popover.position="right"),t.element.indexOf(d["a"].value.recommendStrategy)>-1&&(t.popover.offset=-8,t.popover.position="left"),t.element.indexOf(d["a"].value.changeOrder)>-1&&(t.popover.margin=8,t.popover.offset=-4,t.popover.position="left")})),t},e.prototype.dealTableData=function(t){return this.$route.params.needGuide?(this.dealFirstLoadStrategy(),{list:[{id:"1",name:"__casb_qqwhite",priority:"1",application_scope:{scope:["destination_ip","source_ip","terminal"],destination_ip:["1.1.1.1-2.2.2.2","3.3.3.3"],source_ip:["2.2.2.2-3.3.3.3","4.4.4.4"],terminal:["PC","mobile","shared"],users:[_("人力资源部")]},status:"enable",time_name:"all",creator:_("管理员")}]}):t},e.prototype.dealFirstLoadStrategy=function(){this.isFirstLoadStrategyOrigin=this.isConfigGuideShow,this.updateIsConfigGuideShow(!0)},e.prototype.onHandleKeyword=function(t){this.$_draggableMixin_filter(t)},e.prototype.selectAddStrategyType=function(){this.$_strategyModalMixin_selectAddStrategyType(a["a"],{width:400,props:{addCustomizeStrategy:this.openNewStrategyModal,recommendedStrategy:this.recommendedStrategy,displayType:"modal"}})},e.prototype.openNewStrategyModal=function(t){this.$_strategyModalMixin_addStrategy(r["a"],{cls:"common-modal-with-tips",width:640,props:{templateData:t}})},e.prototype.editStrategyModal=function(){var t=this,e=t.$refs.detail,n=null==e?void 0:e.$_detailMixin_getDetail();t.$_strategyModalMixin_editStrategyModal(r["a"],{cls:"common-modal-with-tips",width:640,props:{templateData:n,isEdit:!0},submit:t.filterRemind,submitCallback:function n(){var o;t.$_tableMixin_refresh(),null===(o=null==e?void 0:e.$_detailMixin_loadDetail)||void 0===o||o.call(e)}})},e.prototype.loadRecommendedStrategys=function(){return b(this,void 0,void 0,(function(){var t,e;return g(this,(function(n){switch(n.label){case 0:return[4,this.$http.get("template/terminal-control")];case 1:return t=n.sent().list,e=void 0===t?[]:t,this.recommendedStrategy=e,[2]}}))}))},e.prototype.updateDrawerStatus=function(t){this.strategyRecord.name=t.name||"-",this.setEditBtnDisabled(!1)},e.prototype.setEditBtnDisabled=function(t){this.editBtnDisabled=t},v([Object(f["a"])((function(t){return{loadParams:{keyword:"",limit:50,user_id:""},pagination:!1,selectionMode:"multi",selectionHide:!1,loadFn:function e(n){return b(void 0,void 0,void 0,(function(){var e,o,i;return g(this,(function(r){switch(r.label){case 0:return[4,t.$_strategyMixin_loadFn(n,t.dealTableData)];case 1:return e=r.sent(),null===(i=null===(o=t.strategyMixin_GuideModal)||void 0===o?void 0:o.$on)||void 0===i||i.call(o,"show",(function(){t.$_guideMixin_init()})),[2,e]}}))}))}}}))],e.prototype,"gridOption",void 0),e=v([Object(o["a"])({components:{AddStrategyTypeSelect:a["a"],RecommendedStrategy:s["a"],TerminalControlDetail:l["a"],TipLayer:c["a"]}})],e)}(Object(o["b"])(i["a"],u["a"])),x=w,S=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),T=Object(S["a"])(x,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("sf-card",{directives:[{name:"set-min-height",rawName:"v-set-min-height"}],staticClass:"common-content--padding common-card--no-head-padding terminal-control"},[n("div",{attrs:{slot:"title"},slot:"title"},[n("lang",[t._v("外设管控策略{#title#}")]),t._v(" "),n("tip-layer",{ref:"tipLayer",attrs:{"tip-text":t._("配置外部设备如U盘、移动硬盘、手机等的接入权限，未配置默认允许。")}})],1),t._v(" "),n("sf-grid",{directives:[{name:"show",rawName:"v-show",value:t.strategysLength||t.isTableLoding,expression:"strategysLength || isTableLoding"}],key:t.mixinKey},[n("sf-toolbar",{ref:"toolbar"},[n("sf-button-blank",{staticClass:"btn-blank",class:t.USER_GUIDE.value.addStrategy,attrs:{"default-disabled":t.isTableLoding,"icon-cls":"icon-gongjulan-xinzeng"},on:{click:function(e){return t.openNewStrategyModal()}}},[n("lang",[t._v("新增{#btn#}")])],1),t._v(" "),n("sf-button-blank",{staticClass:"btn-blank",attrs:{"action-name":"delete","icon-cls":"icon-gongjulan-shanchu"},on:{click:t.filterRemind}},[n("lang",[t._v("删除{#btn#}")])],1),t._v(" "),n("ss-vertical-sep",{attrs:{spacing:0}}),t._v(" "),n("sf-button-blank",{staticClass:"btn-blank",attrs:{"action-name":"enable","icon-cls":"icon-enable"},on:{click:t.filterRemind}},[n("lang",[t._v("启用{#btn#}")])],1),t._v(" "),n("sf-button-blank",{staticClass:"btn-blank",attrs:{"action-name":"disable","icon-cls":"icon-disable"},on:{click:t.filterRemind}},[n("lang",[t._v("禁用{#btn#}")])],1),t._v(" "),n("template",{slot:"right"},[n("sf-searchfield",{attrs:{"param-key":"keyword",placeholder:t._("请输入策略名称")},on:{trigger:t.filterRemind},model:{value:t.gridOption.loadParams.keyword,callback:function(e){t.$set(t.gridOption.loadParams,"keyword",e)},expression:"gridOption.loadParams.keyword"}})],1)],2),t._v(" "),n("sf-table",{directives:[{name:"set-min-height",rawName:"v-set-min-height"}],ref:"table",attrs:{options:t.gridOption,"default-height":300}},[n("sf-table-column",{class:t.USER_GUIDE.value.strategyOrder,attrs:{"data-index":"priority",title:t._("优先级{#header#}"),align:"center","default-width":60}}),t._v(" "),n("sf-table-column",{attrs:{"data-index":"name",title:t._("策略名称{#header#}"),"default-width":.3},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.record;return[n("span",{staticClass:"common-ellipsis common-link__text",class:t.USER_GUIDE.value.viewDetail,attrs:{title:o.name},on:{click:function(e){return e.stopPropagation(),t.$_strategyModalMixin_openDetailDrawer(o)}}},[t._v("\n                        "+t._s(t._f("empty")(o.name))+"\n                    ")])]}}])}),t._v(" "),n("sf-table-column",{attrs:{"data-index":"application",title:t._("适用范围{#header#}"),"default-width":.7},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.record;return[t.$_strategyMixin_isScopeShow(o)?n("div",{staticClass:"terminal-control__scope"},t._l(o.application_scope.scope,(function(e,i){return n("p",{key:i,staticClass:"common-ellipsis terminal-control__scope-item",attrs:{title:t.formatApplicationScope(o.application_scope,e)}},[t._v("\n                            "+t._s(t.formatApplicationScope(o.application_scope,e))+"\n                        ")])})),0):n("span",[t._v("\n                        -\n                    ")])]}}])}),t._v(" "),n("sf-table-column",{attrs:{"data-index":"time_name",title:t._("生效时间{#header#}"),"default-width":104}}),t._v(" "),n("sf-table-column",{attrs:{"data-index":"status",title:t._("策略状态{#header#}"),"default-width":80},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.record;return[o.status?n("i",{staticClass:"iconfont",class:[t.STATUS.icon[o.status],"common-status-icon--"+o.status],attrs:{title:o.status===t.STATUS.value.enable?t.STATUS.actionText.disable:t.STATUS.actionText.enable},on:{click:function(e){return e.stopPropagation(),t.filterRemind(e)}}}):n("span",[t._v("\n                        -\n                    ")])]}}])}),t._v(" "),n("sf-table-column",{attrs:{"data-index":"creator",title:t._("创建人{#header#}"),"default-width":80}}),t._v(" "),n("sf-table-column",{attrs:{title:t._("操作{#header#}"),"default-width":160}},[n("div",{staticClass:"terminal-control__operation"},[n("span",{staticClass:"common-link__text-margin",on:{click:function(e){return e.stopPropagation(),t.filterRemind(e)}}},[t._v("\n                        "+t._s(t._("删除{#btn#}"))+"\n                    ")]),t._v(" "),t.gridOption.loadParams.keyword?t._e():n("draggable-handler",{class:t.USER_GUIDE.value.changeOrder})],1)])],1)],1),t._v(" "),t.strategysLength||t.isTableLoding?t._e():n("add-strategy-type-select",{attrs:{"add-customize-strategy":t.openNewStrategyModal,"recommended-strategy":t.recommendedStrategy,"display-type":"table"}}),t._v(" "),n("sf-drawer",{attrs:{title:t.strategyRecord.name,visible:t.isDetailShow,size:"640px",direction:"rtl","destroy-on-close":!0},on:{"update:visible":function(e){t.isDetailShow=e}}},[n("terminal-control-detail",{ref:"detail",attrs:{record:t.strategyRecord},on:{"before-load":function(e){return t.setEditBtnDisabled(!0)},"after-load":t.updateDrawerStatus}}),t._v(" "),n("template",{slot:"footer"},[n("sf-button-primary",{attrs:{"default-disabled":t.editBtnDisabled},on:{click:t.editStrategyModal}},[n("lang",[t._v("编辑")])],1)],1)],2)],1)}),[],!1,null,"08d4c238",null);e["default"]=T.exports},"./src/home/mod_strategy/online_strategy/control_strategy/terminal_control/modal/add_strategy/index.vue":function(t,e,n){"use strict";var o=n("./node_modules/vue-property-decorator/lib/vue-property-decorator.js"),i=n("./src/home/mod_common/mixin/form.ts"),r=n("./src/home/mod_common/mixin/modal.ts"),a=n("./src/api/swagger/mods/strategyTerminalControl.mod.ts"),s=n("./src/const/common.ts"),l=n("./src/const/mod_strategy.ts"),c=n("./src/components/form/form_base_info/index.vue"),u=n("./src/components/application_scope/index.vue"),d=n("./src/components/local_tips/index.vue"),p=n("./src/components/textarea/index.vue"),f=n("./src/components/check_relevance/index.vue"),m=n("./src/components/icon_qtip/index.vue");function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(t)}var _=function(){var t=function e(n,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(n,o)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),h=function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===("undefined"==typeof Reflect?"undefined":y(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},v=function(t,e,n,o){return new(n||(n=Promise))((function(i,r){function a(t){try{l(o.next(t))}catch(t){r(t)}}function s(t){try{l(o["throw"](t))}catch(t){r(t)}}function l(t){t.done?i(t.value):function e(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,s)}l((o=o.apply(t,e||[])).next())}))},b=function(t,e){var n,o,i,r,a={label:0,sent:function t(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function l(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o["return"]:r[0]?o["throw"]||((i=o["return"])&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},g=/^[a-zA-Z0-9_.\\`~!#$%^&*()+=|{}\[\];:\"',/?]{0,999}$/,w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.deviceIdTip=["请输入设备ID，一行一个，最多支持128个","支持大小写字母、数字、特殊字符_.\\`~!#$%^&*()+=|{}[];:\"',/?；单个ID不超过999位"],e.ids=[],e}return _(e,t),e.prototype.onHandleWhitelist=function(t){this.ids=t},e.prototype.$_modalFormMixin_cancel=function(){this.ids=this.whitelist,this.$emit("close-modal")},e.prototype.$_modalFormMixin_submit=function(){return v(this,void 0,void 0,(function(){return b(this,(function(t){return this.$_formMixin_isValid()?(this.$emit("submit-success",this.ids),this.$emit("close-modal"),[2]):[2]}))}))},e.prototype.idValidator=function(t){return!!g.test(t)||"支持大小写字母、数字、特殊字符_.\\`~!#$%^&*()+=|{}[];:\"',/?；单个ID不超过999位"},h([Object(o["c"])({type:Array,default:function t(){return[]}})],e.prototype,"whitelist",void 0),h([Object(o["c"])({type:Boolean,default:!1})],e.prototype,"defaultDisabled",void 0),h([Object(o["f"])("whitelist",{immediate:!0})],e.prototype,"onHandleWhitelist",null),e=h([Object(o["a"])({components:{IconQtip:m["a"],LocalTips:d["a"],MultiTextarea:p["a"],CheckRelevance:f["a"]}})],e)}(Object(o["b"])(i["a"],r["a"])),x=w,S=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),T=Object(S["a"])(x,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("check-relevance",{attrs:{"can-edit":!t.defaultDisabled}},[n("sf-form",{ref:"form",staticClass:"white-list"},[n("local-tips",{attrs:{"default-width":"100%",type:"normal","tips-text":"以下设备将不受U盘、移动硬盘策略管控，可正常使用"}}),t._v(" "),n("sf-form-item",{attrs:{"label-text":"设备ID"}},[n("span",{staticClass:"white-list__link"},[n("span",{staticClass:"common-link__text",on:{click:t.$filterRemind}},[n("i",{staticClass:"iconfont icon-xinxi12beifen5 download-tip"}),t._v(" "),n("span",[t._v("如何获取U盘设备ID")])])]),t._v(" "),n("multi-textarea",{attrs:{name:"uid",placeholder:t.deviceIdTip.join("\n"),"is-hack-placeholder":"","max-line":128,"single-line-max":999,"line-validator":t.idValidator,rows:5,"default-width":"100%"},model:{value:t.ids,callback:function(e){t.ids=e},expression:"ids"}}),t._v(" "),n("icon-qtip",{staticClass:"common-form-tips-icon",attrs:{"tip-text":t.deviceIdTip.join("<br>")}})],1)],1)],1)}),[],!1,null,"6af7e343",null).exports,O=n("./src/util/tool.js"),k=n("./src/home/mod_common/util/tool.ts");function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(t)}var j=function(){var t=function e(n,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(n,o)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),C=function(){return C=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},C.apply(this,arguments)},$=function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===("undefined"==typeof Reflect?"undefined":D(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},I=function(t,e,n,o){return new(n||(n=Promise))((function(i,r){function a(t){try{l(o.next(t))}catch(t){r(t)}}function s(t){try{l(o["throw"](t))}catch(t){r(t)}}function l(t){t.done?i(t.value):function e(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,s)}l((o=o.apply(t,e||[])).next())}))},E=function(t,e){var n,o,i,r,a={label:0,sent:function t(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function l(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o["return"]:r[0]?o["throw"]||((i=o["return"])&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},M=Object(O["o"])({allow:"可读写",only_read:"只读",forbid:"拒绝"}),P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.STATUS=s["n"],e.AUDIT_SETTINGS_TYPE=l["i"],e.AUDIT_SETTINGS_ACTION=l["h"],e.DISK_ACTION_OPTIONS=M,e.formData={name:"",description:"",status:s["n"].value.enable,priority:"",time_id:"",setting:{disk:l["h"].value.allow,mobile:l["h"].value.allow,net:l["h"].value.allow,bluetooth:l["h"].value.allow,camera:l["h"].value.allow,printer:l["h"].value.allow},application_scope:{scope:Object.values(l["c"].value).filter((function(t){return![l["c"].value.terminal,l["c"].value.sourceIp].includes(t)})),users:[],users_tree:{},terminal:[l["L"].value.pc],source_ip:{type:l["H"].value.all,list:[]},destination_ip:{type:l["s"].value.all,list:[]}}},e.inputWidth=463,e.priorityList=[],e.userTreeData=[],e.timeList=[],e}return j(e,t),e.prototype.created=function(){this.inputWidth=this.$isEnglish?440:463},e.prototype.mounted=function(){this.templateData&&(this.formData=Object(O["n"])({},this.formData,this.templateData)),this.isEdit&&this.initPriorityList(),this.loadTimeList(),this.initUserData()},e.prototype.initPriorityList=function(){var t;return I(this,void 0,void 0,(function(){var e,n,o;return E(this,(function(i){switch(i.label){case 0:return[4,a["a"].lowestPriority({id:(null===(t=this.templateData)||void 0===t?void 0:t.id)||""},{mask:this.$parent})];case 1:for(e=i.sent(),n=(null==e?void 0:e.lowest_priority)||1,o=1;o<=n;o++)this.priorityList.push(o);return[2]}}))}))},e.prototype.initUserData=function(){return I(this,void 0,void 0,(function(){var t;return E(this,(function(e){switch(e.label){case 0:return[4,a["a"].userGroup({},{mask:this.$parent})];case 1:return t=e.sent(),this.userTreeData=t?[t]:[],this.templateData||(this.formData.application_scope.users=Object(O["k"])(this.userTreeData)),[2]}}))}))},e.prototype.openWhitelistModal=function(){var t=this;t.$_modalMixin_showModal(T,{title:"设备白名单",showSuccessMsg:!1,props:{whitelist:t.formData.disk_white_list},submitCallback:function e(n){t.formData.disk_white_list=n}})},e.prototype.loadTimeList=function(){return I(this,void 0,void 0,(function(){var t,e;return E(this,(function(n){switch(n.label){case 0:return[4,a["a"].timeList({},{mask:this.$parent})];case 1:return t=n.sent().list,e=void 0===t?[]:t,this.timeList=e.map(k["d"]),[2]}}))}))},e.prototype.$_formMixin_request=function(){var t,e=this.$_formMixin_getJsonValue(),n=this.isEdit?C(C({},e),{id:(null===(t=this.templateData)||void 0===t?void 0:t.id)||""}):e;return(this.isEdit?a["a"].edit:a["a"].add)(n,{mask:this.$parent})},$([Object(o["c"])({type:Object})],e.prototype,"templateData",void 0),$([Object(o["c"])({type:Boolean,default:!1})],e.prototype,"isEdit",void 0),e=$([Object(o["a"])({components:{BaseInfo:c["a"],ApplicationScope:u["a"],LocalTips:d["a"]}})],e)}(Object(o["b"])(i["a"],r["a"])),R=P,A=Object(S["a"])(R,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("sf-scrollbar",{staticClass:"add-strategy-scrollbar"},[n("local-tips",{attrs:{"default-width":"100%",type:"normal","tips-text":t._("使用引流设备的员工需下载插件并安装至PC才能生效策略（客户端用户无需安装）。{#tip#}")}},[n("router-link",{staticClass:"common-link__text",attrs:{to:{name:"modSettingsClientDownloads"},rel:"noopener noreferrer",target:"_blank"}},[t._v("\n            "+t._s(t._("前往下载{#btn#}"))+"\n        ")])],1),t._v(" "),n("sf-form",{ref:"form",staticClass:"add-strategy",attrs:{"auto-label-width":""}},[n("lang",{staticClass:"common-form-title"},[t._v("基本信息{#title#}")]),t._v(" "),n("base-info",{attrs:{"record-data":t.formData,"priority-list":t.priorityList,"default-width":t.inputWidth,"is-edit":t.isEdit}}),t._v(" "),n("lang",{staticClass:"common-form-title"},[t._v("管控设置{#title#}")]),t._v(" "),t._l(t.AUDIT_SETTINGS_TYPE.options,(function(e,o){return n("sf-form-item",{key:o,attrs:{"label-text":e.label}},[n("sf-radio-group",{class:{"add-strategy__radio-group":t.$isEnglish},attrs:{name:"setting."+e.value},model:{value:t.formData.setting[e.value],callback:function(n){t.$set(t.formData.setting,e.value,n)},expression:"formData.setting[item.value]"}},[e.value===t.AUDIT_SETTINGS_TYPE.value.disk?[t._l(t.DISK_ACTION_OPTIONS,(function(e,o){return n("sf-radio",{key:o,staticClass:"add-strategy__radio",attrs:{"check-value":e.value}},[t._v("\n                        "+t._s(e.label)+"\n                        "),e.value===t.AUDIT_SETTINGS_ACTION.value.only_read?n("span",[n("sf-fieldtip",{staticClass:"add-strategy__radio-readonly-tip"},[n("span",[t._v("只读")])])],1):t._e()])})),t._v(" "),n("sf-button",{staticClass:"add-strategy__whitelist-button",attrs:{size:"small"},on:{click:t.openWhitelistModal}},[n("span",[t._v("设备白名单")])])]:[t._l(t.AUDIT_SETTINGS_ACTION.optionsWithoutWarn,(function(e,o){return n("sf-radio",{key:o,staticClass:"add-strategy__radio",attrs:{"check-value":e.value}},[t._v("\n                            "+t._s(e.label)+"\n                        ")])})),t._v(" "),n("p",{staticClass:"common-form-item-tips--margin add-strategy__tips"},[t._v("\n                            "+t._s(t.AUDIT_SETTINGS_TYPE.tips[e.value]||"")+"\n                        ")])]],2)],1)})),t._v(" "),n("sf-form-item",{attrs:{"label-text":t._("生效时间")}},[n("sf-select",{attrs:{name:"time_id","default-width":t.inputWidth,options:t.timeList,"allow-blank":!1},model:{value:t.formData.time_id,callback:function(e){t.$set(t.formData,"time_id",e)},expression:"formData.time_id"}})],1),t._v(" "),n("lang",{staticClass:"common-form-title"},[t._v("适用范围{#title#}")]),t._v(" "),n("sf-form-item",{attrs:{"label-text":t._("适用范围")}},[n("application-scope",{ref:"applicationScope",attrs:{name:"application_scope","user-tree-data":t.userTreeData,"input-width":t.inputWidth,"is-terminal-control":!0},model:{value:t.formData.application_scope,callback:function(e){t.$set(t.formData,"application_scope",e)},expression:"formData.application_scope"}})],1)],2)],1)}),[],!1,null,"4c459f08",null);e["a"]=A.exports}}]);